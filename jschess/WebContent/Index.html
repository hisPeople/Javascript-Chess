<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>js chess</title>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.3/jquery.min.js"></script>
<script type="text/javascript">
var CELL_SIZE = 100;
var X_CELLS = 8;
var Y_CELLS = 8;
var BOARD_WIDTH = CELL_SIZE * Y_CELLS + 1;
var BOARD_HEIGHT = CELL_SIZE * X_CELLS + 1;


$(document).ready(function() {
    $('body').append('<canvas id="c">');
    var c_can = $('#c');
    c_can.attr('width', BOARD_WIDTH);
    c_can.attr('height',BOARD_HEIGHT);
    var actualCanvas = $('#c')[0];
    var context = actualCanvas.getContext('2d');
    for (var i = 0; i <= 8; i++) {
        var x = CELL_SIZE * i + .5;
        context.moveTo(x, 0);
        context.lineTo(x, BOARD_HEIGHT);
    }

    for (var i = 0; i <= 8; i++) {
        var y = CELL_SIZE * i + .5;
        context.moveTo(0, y);
        context.lineTo(BOARD_WIDTH, y);
    }

    for (var i = 0; i <= 8; i++){
    	for (var j = 0; j <= 8; j++){
    		if(i%2 == 0){
    			if(j%2 == 1){
    				fillCell(i,j);
    			}
    		} else {
    			if(j%2 == 0){
    				fillCell(i,j);
    			}
    		}	
    	}
    }
    context.strokeStyle = "#000";
    context.stroke();
    
    var piece = new Image();
	piece.src = "images/bking.png";
	piece.onload = function() {
		context.drawImage(piece,CELL_SIZE,CELL_SIZE);
	}

    c_can.bind('click', getCursorPosition);
   
    var tp = new testPiece("white");
    tp.printColor();
    
    var tps = new testPieceSubclass("black");
    tps.printColor();
});

function testPiece(color){
	this.color = color;
	this.printColor = printColor;
}

testPieceSubclass.prototype = new testPiece();
testPieceSubclass.constructor = testPieceSubclass;
function testPieceSubclass(color){
	this.color = color;
	this.printColor = function(){
		alert("Overridden! " + this.color);
	}
}

function printColor(){
	alert(this.color);
}

function fillCell(row,col){
	var x = row * CELL_SIZE + .5;
	var y = col * CELL_SIZE + .5;
	var can = $('#c')[0];
	var cntxt = can.getContext('2d');
	cntxt.fillStyle = "#aaa";
	cntxt.fillRect(x,y,CELL_SIZE,CELL_SIZE);
}

function getCursorPosition(e) {
    var x = Math.floor(e.pageX/CELL_SIZE);
    var y = Math.floor(e.pageY/CELL_SIZE);
    alert(x + ", " + y);
}
</script>
</head>
<body>

</body>
</html>